name: starcoder2-ft
workspace: PDK Demos
project: starcoder
debug: true
data:
  data_dir: "/data"
  download_directory: "/tmp"
integrations:
  pachyderm:
    pachd:
      host: 
      port: 
    proxy:
      scheme: https
      host: console.pachpe.com
      port: 443
    dataset:
      branch: 
      commit: 
      project: 
      repo: 
      token:
environment:
  environment_variables:
    - DET_MASTER_CERT_FILE=noverify
  image:
    cuda: bosterbuhrhpe/llm-codegen-ft:0.5
  pod_spec:
    apiVersion: v1
    kind: Pod
    spec:
      containers:
      - name: determined-container
        volumeMounts:
        - mountPath: /cache
          name: efs-cdr-cache
      volumes:
      - name: efs-cdr-cache
        persistentVolumeClaim:
          claimName: efs-cdr-cache
resources:
  slots_per_trial: 4
  resource_pool: gpu-pool
searcher:
  name: single
  max_length:
    batches: 100
  metric: eval_loss
hyperparameters:
  training_arguments:
    learning_rate: .00001
entrypoint: >-
  python -m determined.launch.torch_distributed
  python finetune-mlde.py
  --model_path "/tmp/model"
  --dataset_name
  "/tmp/model/"
  --split
  "train"
  --size_valid_set
  "1000"
  --streaming
  --seq_length
  "2048"
  --max_steps
  "100"
  --batch_size
  "1"
  --input_column_name
  "question"
  --output_column_name
  "response"
  --gradient_accumulation_steps
  "16"
  --lr_scheduler_type
  "cosine"
  --num_warmup_steps
  1
  --weight_decay
  0.05
  --output_dir
  "./outputdir"
  --log_freq
  20
  --save_freq
  50
  --eval_freq
  50
max_restarts: 1
